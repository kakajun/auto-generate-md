{
  "version": 3,
  "sources": ["../src/agmd.ts", "../src/index.ts"],
  "sourcesContent": ["#!/usr/bin/env node\r\n// \u83B7\u53D6\u6587\u4EF6\u7684\u5934\u90E8\u6CE8\u91CA\u5DE5\u5177\r\nimport path from 'path'\r\nimport fs from 'fs'\r\nimport { getMd } from './index'\r\n\r\nconst __dirname = path.resolve()\r\n/**\r\n * @description: \u628A\u7ED3\u679C\u5199\u5165\u5230js\u6587\u4EF6\r\n * @param {data}  \u8981\u5199\u7684\u6570\u636E\r\n * @return {fileName}  \u8981\u5199\u5165\u6587\u4EF6\u5730\u5740\r\n */\r\n// function wirteJs(data: string, filePath: string) {\r\n//   const file = path.resolve(__dirname, filePath)\r\n//   const pre = 'export default'\r\n//   // \u5F02\u6B65\u5199\u5165\u6570\u636E\u5230\u6587\u4EF6\r\n//   fs.writeFile(file, pre + data, { encoding: 'utf8' }, (err) => {\r\n//     console.error(err);\r\n//   })\r\n// }\r\n\r\n/**\r\n * @description: \u628A\u7ED3\u679C\u5199\u5165\u5230js\u6587\u4EF6\r\n * @param {data}  \u8981\u5199\u7684\u6570\u636E\r\n * @return {fileName}  \u8981\u5199\u5165\u6587\u4EF6\u5730\u5740\r\n */\r\nfunction wirteMd(data: string, filePath: string) {\r\n  const file = path.resolve(__dirname, filePath)\r\n  const pre = '```js\\n'\r\n  const last = '```\\n'\r\n  // \u5F02\u6B65\u5199\u5165\u6570\u636E\u5230\u6587\u4EF6\r\n  fs.writeFile(file, pre + data + last, { encoding: 'utf8' }, (err) => { console.error(err);})\r\n}\r\n\r\n/**\r\n * @description: \u81EA\u52A8\u751F\u6210\u5168\u6D41\u7A0B\r\n * @param {*}\r\n * @return {*}\r\n */\r\nfunction agmd() {\r\n  const md = getMd()\r\n  // \u5F97\u5230md\u5BF9\u8C61\r\n  // wirteJs(JSON.stringify(nodes), __dirname + \"\\\\readme-file.js\");\r\n  // \u5F97\u5230md\u6587\u6863\r\n  console.log('\\x1B[36m%s\\x1B[0m', '*** location: ', `${path.resolve('./')}\\\\readme-md.md`)\r\n  wirteMd(md, `${path.resolve('./')}\\\\readme-md.md`)\r\n}\r\nagmd()\r\n", "import fs from 'fs'\r\nimport path from 'path'\r\n\r\n/**\r\n * @description: \u83B7\u53D6\u6587\u4EF6\u7684\u5934\u90E8\u6CE8\u91CA\r\n * @param {*} file\r\n * @return {*}\r\n */\r\nfunction getFile(file: fs.PathOrFileDescriptor) {\r\n  const str = fs.readFileSync(file, 'utf-8')\r\n  const sarr = str.split(/[\\n,]/g)\r\n  // console.log(file);\r\n  const f =\r\n    sarr[0].indexOf('eslint') === -1 &&\r\n    (sarr[0].indexOf('-->') > -1 || sarr[0].indexOf('*/') > -1 || sarr[0].indexOf('//') > -1)\r\n      ? sarr[0]\r\n      : ''\r\n  // console.log(f);\r\n  return f\r\n}\r\n// \u8FC7\u6EE4\u6587\u4EF6\u5939\r\nconst filterArr = ['img', 'styles', 'node_modules', 'LICENSE', '.git', '.github', 'dist', '.husky', '.vscode']\r\n// \u8FD9\u91CC\u53EA\u83B7\u53D6\u67D0\u540E\u7F00\u6587\u4EF6\u7684\u6CE8\u91CA,\u9700\u8981\u5176\u4ED6\u8FD9\u91CC\u52A0\u5165\r\nconst includeArrs = ['.js', '.vue', '.ts']\r\n\r\nexport type ItemType ={\r\n  name: string\r\n  isDir: boolean\r\n  level: number\r\n  note: string\r\n  children?: ItemType[]\r\n}\r\n\r\n/**\r\n * @description: \u751F\u6210\u6240\u6709\u6587\u4EF6\u7684node\u4FE1\u606F\r\n * @param {*} nodes\r\n * @param {*} dir\r\n * @param {*} level\r\n * @return {*}\r\n */\r\n export function getFileNodes(nodes: Array<ItemType> = [], dir = path.resolve('./'), level = 0): Array<ItemType> {\r\n  const files = fs\r\n    .readdirSync(dir)\r\n    .map((item) => {\r\n      const fullPath = path.join(dir, item)\r\n      const isDir = fs.lstatSync(fullPath).isDirectory()\r\n      return {\r\n        name: item,\r\n        isDir,\r\n        level,\r\n        note: ''\r\n      } as ItemType\r\n    })\r\n    // \u5BF9\u6587\u4EF6\u5939\u548C\u6587\u4EF6\u8FDB\u884C\u6392\u5E8F,\u8981\u4E0D\u7136\u751F\u6210\u7684\u548C\u7F16\u8F91\u5668\u6253\u5F00\u7684\u987A\u5E8F\u4E0D\u5BF9\u5E94\r\n    .sort((a, b) => {\r\n      if (!a.isDir && b.isDir) return 1\r\n      if (a.isDir && !b.isDir) return -1\r\n      if ((a.isDir && b.isDir) || (!a.isDir && !b.isDir)) return 0\r\n      return 0\r\n    })\r\n  for (let index = 0; index < files.length; index += 1) {\r\n    const item = files[index]\r\n    let note = '' // \u6587\u4EF6\u6CE8\u91CA\r\n    const arr = filterArr.findIndex((obj) => obj === item.name)\r\n    if (arr === -1) {\r\n      const fullPath = path.join(dir, item.name)\r\n      const isDir = fs.lstatSync(fullPath).isDirectory()\r\n      if (isDir) {\r\n        // \u9012\u5F52\r\n        getFileNodes((item.children = []), fullPath, level + 1)\r\n      } else {\r\n        const i = fullPath.lastIndexOf('.')\r\n        const lastName = fullPath.substring(i)\r\n        // \u8FD9\u91CC\u53EA\u83B7\u53D6js\u548Cvue,ts\u6587\u4EF6\u7684\u6CE8\u91CA\r\n        if (['.js', '.vue', '.ts'].includes(lastName)) {\r\n          note = getFile(fullPath)\r\n        }\r\n        item.note = note\r\n      }\r\n      nodes.push(item)\r\n    }\r\n  }\r\n  // \u63A7\u5236\u8FD4\u56DE\u65F6\u95F4\u8282\u70B9,\u4E0D\u8BA9\u63D0\u524D\u8FD4\u56DE\r\n  return nodes\r\n}\r\n\r\n/**\r\n * @description: \u9012\u5F52\u5F97\u5230\u6587\u4EF6\u540D+note\r\n * @param {*} datas\r\n * @param {*} keys\r\n * @return {*}\r\n */\r\nfunction getNote(datas: Array<ItemType>, keys?: string[]) {\r\n  const nodes = keys || []\r\n  datas.forEach((obj: ItemType) => {\r\n    if (obj.children) {\r\n      // \u6587\u4EF6\u5939\r\n      const md = setMd(obj)\r\n      nodes.push(md)\r\n      getNote(obj.children, nodes)\r\n    }\r\n    // \u6587\u4EF6\r\n    else {\r\n      const md = setMd(obj)\r\n      nodes.push(md)\r\n    }\r\n  })\r\n  return nodes\r\n}\r\n\r\n/**\r\n * @description: \u4E00\u4E2Aobj\u751F\u6210\u4E00\u4E2A\u4E00\u884C\u6587\u5B57\r\n * @param {*} obj\r\n * @return {*}\r\n */\r\nfunction setMd(obj: ItemType): string {\r\n  let filesString = ''\r\n  // \u628A\u6587\u4EF6\u5939\u8F93\u51FA,\u5E76\u4E14level+1\r\n  const blank = '  '.repeat(obj.level) // \u91CD\u590D\u7A7A\u767D\r\n  if (obj.isDir) {\r\n    filesString += `${blank}+ ${obj.name}\\n`\r\n  } else {\r\n    const index = obj.name.lastIndexOf('.')\r\n    const lastName = obj.name.substring(index)\r\n    // \u8FD9\u91CC\u53EA\u83B7\u53D6\u67D0\u540E\u7F00\u6587\u4EF6\u7684\u6CE8\u91CA\r\n    if (includeArrs.includes(lastName) || index === -1) {\r\n      filesString += `${blank}  ${obj.name}            ${obj.note}\\n`\r\n    }\r\n  }\r\n  return filesString\r\n}\r\n\r\nexport function getMd() {\r\n  console.log('\\x1B[36m%s\\x1B[0m', '*** run location: ', path.resolve('./'))\r\n  const nodes = getFileNodes()\r\n  const note = getNote(nodes) // \u5F97\u5230\u6240\u6709note\u7684\u6570\u7EC4\r\n  const md = note.join('') // \u6570\u7EC4\u8F6C\u5B57\u7B26\u4E32\r\n  if (md.length > 0) {\r\n    console.log('\\x1B[36m%s\\x1B[0m', '*** Automatic generation completed ! ')\r\n  }\r\n  return md\r\n}\r\n\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;AAEA,mBAAiB;AACjB,iBAAe;;;ACHf,gBAAe;AACf,kBAAiB;AAOjB,iBAAiB,MAA+B;AAC9C,QAAM,MAAM,kBAAG,aAAa,MAAM;AAClC,QAAM,OAAO,IAAI,MAAM;AAEvB,QAAM,IACJ,KAAK,GAAG,QAAQ,cAAc,MAC7B,MAAK,GAAG,QAAQ,SAAS,MAAM,KAAK,GAAG,QAAQ,QAAQ,MAAM,KAAK,GAAG,QAAQ,QAAQ,MAClF,KAAK,KACL;AAEN,SAAO;AAAA;AAGT,IAAM,YAAY,CAAC,OAAO,UAAU,gBAAgB,WAAW,QAAQ,WAAW,QAAQ,UAAU;AAEpG,IAAM,cAAc,CAAC,OAAO,QAAQ;AAiB5B,sBAAsB,QAAyB,IAAI,MAAM,oBAAK,QAAQ,OAAO,QAAQ,GAAoB;AAC/G,QAAM,QAAQ,kBACX,YAAY,KACZ,IAAI,CAAC,SAAS;AACb,UAAM,WAAW,oBAAK,KAAK,KAAK;AAChC,UAAM,QAAQ,kBAAG,UAAU,UAAU;AACrC,WAAO;AAAA,MACL,MAAM;AAAA,MACN;AAAA,MACA;AAAA,MACA,MAAM;AAAA;AAAA,KAIT,KAAK,CAAC,GAAG,MAAM;AACd,QAAI,CAAC,EAAE,SAAS,EAAE;AAAO,aAAO;AAChC,QAAI,EAAE,SAAS,CAAC,EAAE;AAAO,aAAO;AAChC,QAAK,EAAE,SAAS,EAAE,SAAW,CAAC,EAAE,SAAS,CAAC,EAAE;AAAQ,aAAO;AAC3D,WAAO;AAAA;AAEX,WAAS,QAAQ,GAAG,QAAQ,MAAM,QAAQ,SAAS,GAAG;AACpD,UAAM,OAAO,MAAM;AACnB,QAAI,OAAO;AACX,UAAM,MAAM,UAAU,UAAU,CAAC,QAAQ,QAAQ,KAAK;AACtD,QAAI,QAAQ,IAAI;AACd,YAAM,WAAW,oBAAK,KAAK,KAAK,KAAK;AACrC,YAAM,QAAQ,kBAAG,UAAU,UAAU;AACrC,UAAI,OAAO;AAET,qBAAc,KAAK,WAAW,IAAK,UAAU,QAAQ;AAAA,aAChD;AACL,cAAM,IAAI,SAAS,YAAY;AAC/B,cAAM,WAAW,SAAS,UAAU;AAEpC,YAAI,CAAC,OAAO,QAAQ,OAAO,SAAS,WAAW;AAC7C,iBAAO,QAAQ;AAAA;AAEjB,aAAK,OAAO;AAAA;AAEd,YAAM,KAAK;AAAA;AAAA;AAIf,SAAO;AAAA;AAST,iBAAiB,OAAwB,MAAiB;AACxD,QAAM,QAAQ,QAAQ;AACtB,QAAM,QAAQ,CAAC,QAAkB;AAC/B,QAAI,IAAI,UAAU;AAEhB,YAAM,KAAK,MAAM;AACjB,YAAM,KAAK;AACX,cAAQ,IAAI,UAAU;AAAA,WAGnB;AACH,YAAM,KAAK,MAAM;AACjB,YAAM,KAAK;AAAA;AAAA;AAGf,SAAO;AAAA;AAQT,eAAe,KAAuB;AACpC,MAAI,cAAc;AAElB,QAAM,QAAQ,KAAK,OAAO,IAAI;AAC9B,MAAI,IAAI,OAAO;AACb,mBAAe,GAAG,UAAU,IAAI;AAAA;AAAA,SAC3B;AACL,UAAM,QAAQ,IAAI,KAAK,YAAY;AACnC,UAAM,WAAW,IAAI,KAAK,UAAU;AAEpC,QAAI,YAAY,SAAS,aAAa,UAAU,IAAI;AAClD,qBAAe,GAAG,UAAU,IAAI,mBAAmB,IAAI;AAAA;AAAA;AAAA;AAG3D,SAAO;AAAA;AAGF,iBAAiB;AACtB,UAAQ,IAAI,eAAqB,sBAAsB,oBAAK,QAAQ;AACpE,QAAM,QAAQ;AACd,QAAM,OAAO,QAAQ;AACrB,QAAM,KAAK,KAAK,KAAK;AACrB,MAAI,GAAG,SAAS,GAAG;AACjB,YAAQ,IAAI,eAAqB;AAAA;AAEnC,SAAO;AAAA;;;ADtIT,IAAM,YAAY,qBAAK;AAoBvB,iBAAiB,MAAc,UAAkB;AAC/C,QAAM,OAAO,qBAAK,QAAQ,WAAW;AACrC,QAAM,MAAM;AACZ,QAAM,OAAO;AAEb,qBAAG,UAAU,MAAM,MAAM,OAAO,MAAM,EAAE,UAAU,UAAU,CAAC,QAAQ;AAAE,YAAQ,MAAM;AAAA;AAAA;AAQvF,gBAAgB;AACd,QAAM,KAAK;AAIX,UAAQ,IAAI,eAAqB,kBAAkB,GAAG,qBAAK,QAAQ;AACnE,UAAQ,IAAI,GAAG,qBAAK,QAAQ;AAAA;AAE9B;",
  "names": []
}
