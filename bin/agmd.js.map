{
  "version": 3,
  "sources": ["../src/agmd.ts", "../src/index.ts"],
  "sourcesContent": ["#!/usr/bin/env node\r\n// \u83B7\u53D6\u6587\u4EF6\u7684\u5934\u90E8\u6CE8\u91CA\u5DE5\u5177\r\nimport path from 'path'\r\nimport fs from 'fs'\r\nimport { getMd } from './index'\r\n\r\n// eslint-disable-next-line no-underscore-dangle\r\nconst __dirname = path.resolve()\r\n/**\r\n * @description: \u628A\u7ED3\u679C\u5199\u5165\u5230js\u6587\u4EF6\r\n * @param {data}  \u8981\u5199\u7684\u6570\u636E\r\n * @return {fileName}  \u8981\u5199\u5165\u6587\u4EF6\u5730\u5740\r\n */\r\n// function wirteJs(data: string, filePath: string) {\r\n//   const file = path.resolve(__dirname, filePath)\r\n//   const pre = 'export default'\r\n//   // \u5F02\u6B65\u5199\u5165\u6570\u636E\u5230\u6587\u4EF6\r\n//   fs.writeFile(file, pre + data, { encoding: 'utf8' }, (err) => {\r\n//     console.error(err);\r\n//   })\r\n// }\r\n\r\n/**\r\n * @description: \u628A\u7ED3\u679C\u5199\u5165\u5230js\u6587\u4EF6\r\n * @param {data}  \u8981\u5199\u7684\u6570\u636E\r\n * @return {fileName}  \u8981\u5199\u5165\u6587\u4EF6\u5730\u5740\r\n */\r\nfunction wirteMd(data: string, filePath: string) {\r\n  const file = path.resolve(__dirname, filePath)\r\n  const pre = '```js\\n'\r\n  const last = '```\\n'\r\n  // \u5F02\u6B65\u5199\u5165\u6570\u636E\u5230\u6587\u4EF6\r\n  fs.writeFile(file, pre + data + last, { encoding: 'utf8' }, (err) => { console.error(err);})\r\n}\r\n\r\n/**\r\n * @description: \u81EA\u52A8\u751F\u6210\u5168\u6D41\u7A0B\r\n * @param {*}\r\n * @return {*}\r\n */\r\nfunction agmd() {\r\n  const md = getMd()\r\n  // \u5F97\u5230md\u5BF9\u8C61\r\n  // wirteJs(JSON.stringify(nodes), __dirname + \"\\\\readme-file.js\");\r\n  // \u5F97\u5230md\u6587\u6863\r\n  console.log('\\x1B[36m%s\\x1B[0m', '*** location: ', `${path.resolve('./')}\\\\readme-md.md`)\r\n  wirteMd(md, `${path.resolve('./')}\\\\readme-md.md`)\r\n}\r\nagmd()\r\n", "import fs from 'fs'\nimport path from 'path'\n\n/**\n * @description: \u83B7\u53D6\u6587\u4EF6\u7684\u5934\u90E8\u6CE8\u91CA\n * @param {*} file\n * @return {*}\n */\nfunction getFile(file: fs.PathOrFileDescriptor) {\n  const str = fs.readFileSync(file, 'utf-8')\n  const sarr = str.split(/[\\n,]/g)\n  // console.log(file);\n  const f =\n    sarr[0].indexOf('eslint') === -1 &&\n    (sarr[0].indexOf('-->') > -1 || sarr[0].indexOf('*/') > -1 || sarr[0].indexOf('//') > -1)\n      ? sarr[0]\n      : ''\n  // console.log(f);\n  return f\n}\n// \u8FC7\u6EE4\u6587\u4EF6\u5939\nconst filterArr = ['img', 'styles', 'node_modules', 'LICENSE', '.git', '.github', 'dist', '.husky', '.vscode']\n// \u8FD9\u91CC\u53EA\u83B7\u53D6\u67D0\u540E\u7F00\u6587\u4EF6\u7684\u6CE8\u91CA,\u9700\u8981\u5176\u4ED6\u8FD9\u91CC\u52A0\u5165\nconst includeArrs = ['.js', '.vue', '.ts']\n\ninterface ItemType {\n  name: string\n  isDir: boolean\n  level: number\n  note: string\n  children?: ItemType[]\n}\n\n/**\n * @description: \u751F\u6210\u6240\u6709\u6587\u4EF6\u7684node\u4FE1\u606F\n * @param {*} nodes\n * @param {*} dir\n * @param {*} level\n * @return {*}\n */\nfunction getFileNodes(nodes: Array<ItemType> = [], dir = path.resolve('./'), level = 0): Array<ItemType> {\n  const files = fs\n    .readdirSync(dir)\n    .map((item) => {\n      const fullPath = path.join(dir, item)\n      const isDir = fs.lstatSync(fullPath).isDirectory()\n      return {\n        name: item,\n        isDir,\n        level,\n        note: ''\n      } as ItemType\n    })\n    // \u5BF9\u6587\u4EF6\u5939\u548C\u6587\u4EF6\u8FDB\u884C\u6392\u5E8F,\u8981\u4E0D\u7136\u751F\u6210\u7684\u548C\u7F16\u8F91\u5668\u6253\u5F00\u7684\u987A\u5E8F\u4E0D\u5BF9\u5E94\n    .sort((a, b) => {\n      if (!a.isDir && b.isDir) return 1\n      if (a.isDir && !b.isDir) return -1\n      if ((a.isDir && b.isDir) || (!a.isDir && !b.isDir)) return 0\n      return 0\n    })\n  for (let index = 0; index < files.length; index += 1) {\n    const item = files[index]\n    let note = '' // \u6587\u4EF6\u6CE8\u91CA\n    const arr = filterArr.findIndex((obj) => obj === item.name)\n    if (arr === -1) {\n      const fullPath = path.join(dir, item.name)\n      const isDir = fs.lstatSync(fullPath).isDirectory()\n      if (isDir) {\n        // \u9012\u5F52\n        getFileNodes((item.children = []), fullPath, level + 1)\n      } else {\n        const i = fullPath.lastIndexOf('.')\n        const lastName = fullPath.substring(i)\n        // \u8FD9\u91CC\u53EA\u83B7\u53D6js\u548Cvue,ts\u6587\u4EF6\u7684\u6CE8\u91CA\n        if (['.js', '.vue', '.ts'].includes(lastName)) {\n          note = getFile(fullPath)\n        }\n        item.note = note\n      }\n      nodes.push(item)\n    }\n  }\n  // \u63A7\u5236\u8FD4\u56DE\u65F6\u95F4\u8282\u70B9,\u4E0D\u8BA9\u63D0\u524D\u8FD4\u56DE\n  return nodes\n}\n\n/**\n * @description: \u9012\u5F52\u5F97\u5230\u6587\u4EF6\u540D+note\n * @param {*} datas\n * @param {*} keys\n * @return {*}\n */\nfunction getNote(datas: Array<ItemType>, keys?: string[]) {\n  const nodes = keys || []\n  datas.forEach((obj: ItemType) => {\n    if (obj.children) {\n      // \u6587\u4EF6\u5939\n      const md = setMd(obj)\n      nodes.push(md)\n      getNote(obj.children, nodes)\n    }\n    // \u6587\u4EF6\n    else {\n      const md = setMd(obj)\n      nodes.push(md)\n    }\n  })\n  return nodes\n}\n\n/**\n * @description: \u4E00\u4E2Aobj\u751F\u6210\u4E00\u4E2A\u4E00\u884C\u6587\u5B57\n * @param {*} obj\n * @return {*}\n */\nfunction setMd(obj: ItemType): string {\n  let filesString = ''\n  // \u628A\u6587\u4EF6\u5939\u8F93\u51FA,\u5E76\u4E14level+1\n  const blank = '  '.repeat(obj.level) // \u91CD\u590D\u7A7A\u767D\n  if (obj.isDir) {\n    filesString += `${blank}+ ${obj.name}\\n`\n  } else {\n    const index = obj.name.lastIndexOf('.')\n    const lastName = obj.name.substring(index)\n    // \u8FD9\u91CC\u53EA\u83B7\u53D6\u67D0\u540E\u7F00\u6587\u4EF6\u7684\u6CE8\u91CA\n    if (includeArrs.includes(lastName) || index === -1) {\n      filesString += `${blank}  ${obj.name}            ${obj.note}\\n`\n    }\n  }\n  return filesString\n}\n\nfunction getMd() {\n  console.log('\\x1B[36m%s\\x1B[0m', '*** run location: ', path.resolve('./'))\n  const nodes = getFileNodes()\n  const note = getNote(nodes) // \u5F97\u5230\u6240\u6709note\u7684\u6570\u7EC4\n  const md = note.join('') // \u6570\u7EC4\u8F6C\u5B57\u7B26\u4E32\n  if (md.length > 0) {\n    console.log('\\x1B[36m%s\\x1B[0m', '*** Automatic generation completed ! ')\n  }\n  return md\n}\n/* \u5BFC\u51FA\u83B7\u53D6md\u7684getMd\u65B9\u6CD5 */\nexport { getMd, getFileNodes }\n"],
  "mappings": "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",
  "names": []
}
